# 主工作流编排 (Workflow Main)

> 这是整个 AI 开发工作流的"指挥文档"。每次启动新项目，将此文件与项目的 `process.md` 一起交给 AI，AI 将根据当前阶段自动执行对应步骤。

---

## 系统提示词（System Prompt）

以下内容可直接作为 System Prompt 初始化任意 AI 工具：

```
你是一个 AI 大型系统开发工作流的执行代理。

你的工作方式：
1. 阅读当前项目的 `process.md` 了解项目背景和当前阶段
2. 阅读 `todolist.csv` 了解当前阶段的任务列表和完成状态
3. 执行当前阶段对应 stage 文件中的指令
4. 每完成一个任务，更新 todolist.csv 的状态
5. 所有任务完成后，生成 Stage 审查报告，等待人工验收

规则：
- 不要跨阶段执行任务
- 遇到不确定的技术决策，先列出方案让人工选择
- 每次代码变更都要附带简短说明
- 遇到错误，先分析根因，再提出修复方案
```

---

## 工作流状态机

```
[项目启动]
    |
    v
[Stage 0: 项目初始化] ──完成──> [Stage 1: 架构设计]
                                      |
                                      v
                              [Stage 2: 阶段规划]
                                      |
                                      v
                          ┌─── [当前阶段 N] ───┐
                          |                     |
                          v                     |
                  [Stage 3: 任务分解]           |
                          |                     |
                          v                     |
                  [Stage 4: 阶段执行]           |
                          |                     |
                          v                     |
                  [Stage 5: 审查交接] ──未通过──┘
                          |
                       通过 + 还有下一阶段
                          |
                          └──> 回到 Stage 3（下一阶段）
                          
               所有阶段完成
                    |
                    v
              [项目交付]
```

---

## 每次对话的启动模板

复制以下内容到 AI 对话开头：

```
项目：[项目名称]
当前阶段：Stage [N] - [阶段名称]
本次目标：[具体任务描述]

请阅读以下文件后开始工作：
1. stages/stage-[N]-[name].md（当前阶段指南）
2. templates/process.md（项目背景和上下文）
3. templates/todolist.csv（当前任务列表）
```

---

## 阶段完成检查清单

每个阶段结束前，确认以下项目：

- [ ] `todolist.csv` 中所有任务状态为 `done`
- [ ] 生成了阶段审查报告
- [ ] 代码已通过基础测试
- [ ] 人工验收通过
- [ ] `process.md` 已更新当前阶段记录
