# Stage 5: 审查交接

**输入**：完成的代码、测试报告、更新的 `todolist.csv`  
**输出**：审查报告、人工验收通过/未通过决定  

---

## AI 自动审查清单

在提交人工验收前，AI 先完成以下自动检查：

### 代码质量
```bash
# 1. 测试覆盖率
npm run test:coverage

# 2. 类型检查
npm run type-check

# 3. 代码规范
npm run lint

# 4. 构建是否成功
npm run build
```

### 功能完整性检查

```markdown
## 自动检查报告

### todolist.csv 完成情况
- 总任务数：[N]
- 已完成：[N]
- 未完成：[N]（列出未完成任务）

### 测试报告
- 测试通过：[N/N]
- 覆盖率：[XX%]
- 失败用例：[列出失败用例]

### 构建状态
- [ ] 开发构建：✅/❌
- [ ] 生产构建：✅/❌
```

---

## 人工验收流程

### 提交审查时提供

```markdown
## 阶段 [N] 审查报告

**阶段**：[阶段名称]
**完成时间**：[日期]
**执行工具**：[使用了哪些 AI 工具]

### 已完成功能
1. [功能1]：[描述，如何验证]
2. [功能2]：[描述，如何验证]

### API 接口清单
| 方法 | 路径 | 描述 | 状态 |
|------|------|------|------|
| GET | /api/v1/users | 获取用户列表 | ✅ |
| POST | /api/v1/users | 创建用户 | ✅ |

### 验收步骤（给人工执行）
1. 拉取最新代码：`git pull origin main`
2. 安装依赖：`npm install`
3. 启动服务：`npm run dev`
4. 测试用例：
   - 场景1：[操作步骤] → [预期结果]
   - 场景2：[操作步骤] → [预期结果]

### 已知问题/待优化
- [问题1]：[描述]（计划在阶段N修复）
- [优化1]：[描述]（非必须，可延后）

### 代码变更统计
- 新增文件：[N] 个
- 修改文件：[N] 个
- 测试覆盖率：[XX%]
```

---

## 验收决策

### ✅ 通过（进入下一阶段）

```markdown
## 验收通过记录

**验收人**：[姓名]
**验收时间**：[日期时间]
**下一阶段**：阶段 [N+1] - [名称]

备注：[可选]
```

更新 `process.md` 中的阶段状态为 `done`，并开始下一阶段的 Stage 3。

### ❌ 未通过（需要修复）

```markdown
## 验收未通过记录

**验收人**：[姓名]
**验收时间**：[日期时间]

### 必须修复的问题
1. [问题描述1]：[期望行为]
2. [问题描述2]：[期望行为]

### 可选修复
- [非阻塞性问题]
```

将问题添加到 `todolist.csv`（status=todo），返回 Stage 4 修复。

---

## 阶段循环判断

```
IF 还有未完成的开发阶段:
  → 返回 Stage 3（下一个开发阶段的任务分解）
ELSE:
  → 项目交付
```

---

## 项目交付清单（最终阶段完成后）

- [ ] 所有功能已实现并验收
- [ ] 技术文档已更新（README、API 文档）
- [ ] 部署脚本已准备
- [ ] 监控告警已配置
- [ ] 运维手册已编写
- [ ] 代码已合并到主分支并打 tag
